var AbstractPacketConverter = require('./AbstractPacketConverter.js')
, AbstractAPRSMessage = require('../../packets/AbstractAPRSMessage.js')
, APRSMessage = require('../../packets/APRSMessage.js')
, APRSPositionReport = require('../../packets/APRSPositionReport.js')
, ObjectReport = require('../../packets/ObjectReport.js')
;

var instance = null;

function AGWPEPacketConverter() {
	AbstractPacketConverter.apply(this, arguments);
    
    instance = this;
}

AGWPEPacketConverter.prototype = new AbstractPacketConverter();
AGWPEPacketConverter.prototype.constructor = AGWPEPacketConverter;

AGWPEPacketConverter.prototype.ToOutputFormat = ToOutputFormat;

function ToOutputFormat(packet) {
    var retVal = packet.messageType;
    
    if(packet instanceof APRSPositionReport) {
        retVal += instance.FormatPositionReport(packet);
    } else if(packet instanceof APRSMessage && packet.addressee != 'BLN' && packet.addressee.indexOf('NWS-') < 0) {
        retVal += instance.FormatMessage(packet);
    }
    
    //retVal += '\r';
    
    return new Buffer(retVal);
};

module.exports = AGWPEPacketConverter;